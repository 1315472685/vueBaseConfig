webpackJsonp([632],{"1yl7":function(s,a,r){s.exports=r("O8u5")},O8u5:function(s,a,r){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=r("OTyR"),n=r("vSla"),e=n(null,t.a,!1,null,null,null);a.default=e.exports},OTyR:function(s,a,r){"use strict";var t=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},n=[function(){var s=this,a=s.$createElement,r=s._self._c||a;return r("section",[r("h1",[s._v("Axios 拦截器")]),s._v(" "),r("hr"),s._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[s._v("拦截器的意义是为了对项目中 http 请求进行一层拦截和过滤\n")])]),s._v(" "),r("p",[s._v("常见的需求有：当页面请求需要判断接口状态是否为 401 等情况做一些特殊处理，如遇见 401 的接口状态跳登录页，这个时候即可避免每个页面重复判断的冗余")]),s._v(" "),r("p",[s._v("配置入口："),r("code",{pre:!0,attrs:{class:"code_inline"}},[s._v("src/utils/fetch.js")])]),s._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":"",class:"language-js"}},[r("span",{attrs:{class:"hljs-comment"}},[s._v("// request拦截器")]),s._v("\n"),r("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" axios "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{attrs:{class:"hljs-string"}},[s._v("'axios'")]),s._v("\n\n"),r("span",{attrs:{class:"hljs-comment"}},[s._v("// 创建axios实例")]),s._v("\n"),r("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" service = axios.create({\n  "),r("span",{attrs:{class:"hljs-attr"}},[s._v("timeout")]),s._v(": "),r("span",{attrs:{class:"hljs-number"}},[s._v("10000")]),s._v(" "),r("span",{attrs:{class:"hljs-comment"}},[s._v("// 请求超时时间")]),s._v("\n})\n"),r("span",{attrs:{class:"hljs-comment"}},[s._v("// request拦截器")]),s._v("\nservice.interceptors.request.use(\n  "),r("span",{attrs:{class:"hljs-function"}},[r("span",{attrs:{class:"hljs-params"}},[s._v("config")]),s._v(" =>")]),s._v(" {\n    "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" config\n  },\n  err => {\n    "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".reject(err)\n  }\n)\n\n"),r("span",{attrs:{class:"hljs-comment"}},[s._v("// http response 服务器响应拦截器")]),s._v("\nservice.interceptors.response.use(\n  "),r("span",{attrs:{class:"hljs-function"}},[r("span",{attrs:{class:"hljs-params"}},[s._v("response")]),s._v(" =>")]),s._v(" {\n    "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" response\n  },\n  error => {\n    "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (error.response) {\n      "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("switch")]),s._v(" (error.response.status) {\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("400")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("`错误请求："),r("span",{attrs:{class:"hljs-subst"}},[s._v("${error.response.data}")]),s._v("`")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("401")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'未授权，请重新登录'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("403")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'拒绝访问'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("404")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'请求错误,未找到该资源'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("405")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'请求方法未允许'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("408")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'请求超时'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("500")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'服务器端出错'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("501")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'网络未实现'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("502")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'网络错误'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("503")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'服务不可用'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("504")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'网络超时'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" "),r("span",{attrs:{class:"hljs-number"}},[s._v("505")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'http版本不支持该请求'")]),s._v("\n          "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n        "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(":\n          error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("`连接错误"),r("span",{attrs:{class:"hljs-subst"}},[s._v("${error.response.status}")]),s._v("`")]),s._v("\n      }\n    } "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n      error.message = "),r("span",{attrs:{class:"hljs-string"}},[s._v("'服务器异常'")]),s._v("\n    }\n    "),r("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.message)\n    "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".reject(error.response.data)\n  }\n)\n"),r("span",{attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" service\n")])]),s._v(" "),r("p",[s._v("以上的配置，是在脚手架默认自带的，可根据实际需求修改。")]),s._v(" "),r("h2",[s._v("调用 Axios")]),s._v(" "),r("p",[s._v("具体："),r("a",{attrs:{href:"#/cli/vue-set/api"}},[s._v("API 管理方案")]),s._v(" -> 子 API 文件配置")])])}],e={render:t,staticRenderFns:n};a.a=e}});