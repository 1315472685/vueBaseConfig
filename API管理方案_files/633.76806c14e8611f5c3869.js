webpackJsonp([633],{BLLF:function(s,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("H0Hp"),r=t("vSla"),l=r(null,n.a,!1,null,null,null);a.default=l.exports},H0Hp:function(s,a,t){"use strict";var n=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("h1",[s._v("API 管理方案")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("项目中，接口是一种很常见数据交互。为此有各式各样的管理方案")]),s._v(" "),t("h2",[s._v("以往场景方案")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[s._v("方案一：直接在页面上调用接口，但这样的行为会造成后患，当修改了某个接口地址，而接口又被不同页面多个地方调用，这时修改的成本和出错率就会大幅度提升\n\n方案二：在某个 js 文件里面专门存储接口内容。但这样的行为会造成一个 JS 文件多达 3000~5000 行代码以上，维护性差、不利于多人协助开发\n")])]),s._v(" "),t("h2",[s._v("推荐方案")]),s._v(" "),t("p",[s._v("根据以往常见的管理方案，我们的设计思路是：由一个 JS 文件作为 总 API 出口，由这个 总 API 文件 来引入其他模块 API 文件并暴露，在页面调用接口的时候 统一引入 API 出口文件调用")]),s._v(" "),t("p",[s._v("总 API 文件路径： "),t("code",{pre:!0,attrs:{class:"code_inline"}},[s._v("src/api/api.js")])]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" authApi "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"hljs-string"}},[s._v("'./authApi'")]),s._v(" "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 引入子API文件")]),s._v("\n\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" { authApi } "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 暴露子API")]),s._v("\n")])]),s._v(" "),t("p",[s._v("子 API 文件配置")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[t("span",{attrs:{class:"hljs-comment"}},[s._v("/**\n * 认证接口\n * @type {{ login: ((params?)) }}\n */")]),s._v("\n\n"),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 引入拦截器")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Ajax "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"hljs-string"}},[s._v("'@/utils/fetch'")]),s._v("\n"),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 引入公共JS")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" until "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"hljs-string"}},[s._v("'@/utils/until'")]),s._v("\n\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" Qs "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"hljs-string"}},[s._v("'qs'")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" base = until.apiPath\n\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" authApi = {\n  "),t("span",{attrs:{class:"hljs-comment"}},[s._v("/**\n   * 后台登录\n   * @param {String} userName 帐号\n   * @param {String} password 密码 md5 加密\n   * @param {String} opts 配置请求参数\n   */")]),s._v("\n  login(params, opts) {\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" data = params\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" Ajax({\n      "),t("span",{attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),t("span",{attrs:{class:"hljs-string"}},[s._v("`"),t("span",{attrs:{class:"hljs-subst"}},[s._v("${base}")]),s._v("dsf/login`")]),s._v(",\n      "),t("span",{attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),t("span",{attrs:{class:"hljs-string"}},[s._v("'post'")]),s._v(",\n      data,\n      opts\n    })\n  }\n}\n\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" authApi\n")])]),s._v(" "),t("p",[s._v("调用 API")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[s._v("<script type="),t("span",{attrs:{class:"hljs-string"}},[s._v('"text/ecmascript-6"')]),s._v(">\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { authApi } "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"hljs-string"}},[s._v("'@/api/api'")]),s._v(" "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 引入API")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  data() {\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 用户信息")]),s._v("\n      user: {\n        "),t("span",{attrs:{class:"hljs-attr"}},[s._v("userName")]),s._v(": "),t("span",{attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(",\n        "),t("span",{attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": "),t("span",{attrs:{class:"hljs-string"}},[s._v("'123456'")]),s._v("\n      }\n    }\n  },\n  "),t("span",{attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),t("span",{attrs:{class:"hljs-attr"}},[s._v("submit")]),s._v(": "),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n      "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" params = {\n        "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// \b获取用户信息")]),s._v("\n        userName: "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".user.userName,\n        "),t("span",{attrs:{class:"hljs-attr"}},[s._v("password")]),s._v(": "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".user.password\n      }\n      "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 调用 authApi 的login方法")]),s._v("\n      authApi\n        .login(params)\n        .then("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("response")]),s._v(" =>")]),s._v(" {\n          "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 请求成功")]),s._v("\n        })\n        .catch("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("err")]),s._v(" =>")]),s._v(" {\n          "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 请求异常")]),s._v("\n        })\n    }\n  },\n}\n<"),t("span",{attrs:{class:"hljs-regexp"}},[s._v("/script>\n")])])])])}],l={render:n,staticRenderFns:r};a.a=l},jOhJ:function(s,a,t){s.exports=t("BLLF")}});